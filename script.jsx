var comments1 = [ 0, "Kem", "Excuse me.  But I was wondering if you could tell me what’s going on here?",
1, "bescalis", "Oh?  Someone else has joined our conversation?",
2, "Kem", "Oh, you already have a conversation in progress?",
3, "boscalis", "Well, you could say it’s more of an argument really.  But yes, a conversation is in progress.  We both hold contradicting viewpoints regarding a certain proposition, and we’re unable to determine which of us is correct.  We don’t know, methodologically, how we might proceed in resolving our disagreement.",
4, "bescalis", "It’s quite troublesome.",
5, "Kem", "Yes, I agree, that does sound troublesome… if you don’t mind me asking, how long have you been arguing about this?",
6, "bescalis", "Oh goodness, for a very long time, certainly, I really have no way of knowing… what about you, do you know?",
7, "boscalis", "Your guess is as good as mine.  I suppose my memory’s gotten a little fuzzy.  All I know is that we’ve been talking about this for a very long time and nothing has changed.",
8, "bescalis", "Well, there you have it!  Neither of us knows.  How silly!",
9, "Kem", "I see… and, are you sure that your viewpoints are in genuine conflict?",
10, "boscalis", "Yes, absolutely.  That is one of the only things we are able to agree on!  It is clear that I believe one thing, and he believes the exact negation of it.  It is impossible that both of us could turn out to be correct.  One of us has to revise our beliefs.",
10, "Kem", "I see.  Then, I would like to make a proposal, if you’ll be willing to hear it.",
10, "boscalis", "By all means, continue.",
10, "Kem", "I propose that you each deploy a series of arguments in defense of your respective positions. You will attempt to show that your positions follow, as allowed by the constraints of reason, from a set of initial assumptions that you can both agree on.  I will then adjudicate, based on the provided arguments and evidence, who has mounted a stronger defense, and, ultimately, who has made the correct claim.",
10, "bescalis", "That sounds wonderful!",
10, "boscalis", "Indeed, I see no issues with that.  Another thing that we are capable of agreeing on!  Perhaps there is hope for a resolution after all.",
10, "Kem", "It's decided then. The discussion will proceed as I have outlined it.",
10, "bescalis", "I am very excited to see what the outcome of your judgement will be.  I’m sure that we’ll both be very pleased with it!",
1, "Kem", "Now then, are you prepared to hear my initial comments?",
2, "boscalis", "Yes, I would say that, at this point, I am \"prepared\".",
3, "qzzy", "Ah! … oh, goodness… it appears I’ve wandered into something here.",
4, "Kem", "Oh, we have another guest?",
5, "qzzy", "Oh, please, don’t mind me… I don’t even quite know where I am right now.  I don’t know what’s going on here.",
6, "Kem", "Well, that’s how I started out too, so let me explain things a little bit!  We’re having a conversation; the three of us are going to talk for a while.",
7, "qzzy", "A conversation?  That sounds lovely!",
8, "Kem", "Would you like to listen in?  All that wandering must be tiring.  You’re free to rest here for a while.",
9, "qzzy", "Well, I was wandering aimlessly without much of a goal in mind.  In general, that’s what I prefer to be doing, since I’m never quite sure where I’ll end up… but, since you’ve been so gracious in your invitation, and since I seem to have no real reason to prefer to be somewhere else any more than preferring being here, I suppose I’ll stay… yes, I would like to listen in.",
10, "Kem", "We’re happy to have you then!  The more the merrier!",
10, "qzzy", "Yes, thank you very much!  I only have one question though… would you be able to explain the purpose of the conversation?  Or, more precisely, its subject matter?",
10, "Kem", "Ah, unfortunately, that’s not something I’m able to do right now.  It would take quite a while, and I’m too preoccupied with actually engaging in the conversation at the moment.  But if you just stay and listen for awhile, I’m sure you’ll be able to figure out pretty quickly on your own what the conversation is about.  Then you won’t need my help.",
10, "qzzy", "Ok, I’ll do that!",
1, "Kem", "Very well.  I believe we are free to resume the conversation now.",
2, "bescalis", "“Resume” the conversation?  Don’t you mean, “initiate”?  Since the two of us have not really initiated our conversation with you yet.  We are still waiting on your opening remarks.",
3, "Kem", "Yes, you’re entirely correct, my mistake.",
4, "bescalis", "Oh, it’s no trouble at all. The two of us are no strangers to making mistakes either. After all, one of us has, by definition, already made a mistake!  That’s why we’re having this conversation.",
5, "Kem", "Quite right you are!",
6, "bescalis", "Now, are you ready to deliver your opening remarks?",
7, "Kem", "Yes, I certainly believe I am.",
8, "azerman", "Um… excuse me…",
9, "Kem", "Oh?  Do we have another guest?",
10, "azerman", "I… I’ve been listening to some of what you’ve been saying so far, even though you didn’t know, and I…",
10, "Kem", "Yes?",
10, "azerman", "...I missed the beginning.  I don’t know what the conversation is about.  And I would really appreciate it if you could explain it to me.",
10, "Kem", "Well, you did hear what I said to our last guest, correct?",
10, "azerman", "...yes, I did.",
10, "Kem", "Then my answer to you is the same.  I’m much too busy to explain things from the beginning.",
10, "azerman", "But may I at least listen to the conversation?",
10, "Kem", "Certainly, I have no problem with that.  If you want to listen to the conversation and try on your own to figure out what’s going on, then that’s fine.  But I will not give you the explanation myself.  That will have to wait until the end.",
10, "azerman", "I see… normally I would be fine with that, but…",
10, "Kem", "Yes?",
10, "azerman", "I’m afraid that you’ll leave me before you get the chance to explain.  I’m afraid that I’ll be abandoned by you.  And everyone else participating in the conversation too.  Then you’ll never get a chance to explain to me what it was about.",
10, "Kem", "Hmm, that’s a natural worry I suppose.  All I can do is give you my guarantee that that won’t happen.  I will eventually explain the conversation to you.",
10, "azerman", "Alright, I’ll trust you.",
1, "boscalis", "I have been using this time to prepare some of my initial arguments.  May I recite them now?",
2, "Kem", "Certainly!",
3, "74m", "Very curious…",
4, "Kem", "What’s that?  Are you someone else who wants to know what our conversation is about?",
5, "74m", "No, I’m not really interested in that.",
6, "Kem", "Well then, why are you here?  And what exactly was so “curious”?",
7, "74m", "Well, what I really find curious is you people.",
8, "Kem", "Why’s that?",
9, "74m", "It’s difficult to place it, exactly.  It’s just a feeling that I get.  I feel as though your thoughts and words were stolen from somewhere far away, and I view everything about you as though it were being seen through a pale looking glass.  That’s the feeling that I get.",
10, "Kem", "What a strange feeling that is!  I’ve never heard of anything quite like that, have any of you?",
10, "bescalis", "No, I certainly haven’t.",
10, "74m", "I know it does sound strange.  But it’s not as though I can help it.",
10, "Kem", "Well, maybe if you learn more about us, then that will change your evaluation of us?  I know you said earlier that you weren’t interested in the topic of our conversation, but you’re of course welcome to stay and listen nonetheless.",
10, "74m", "Well… without anything better to do, I suppose I will do that.  I may indeed end up learning something about you.",
1, "Kem", "Ah, goodness!  We’ve lost so much time already!",
2, "boscalis", "Assuming no further interruptions, are you ready to hear my initial arguments?",
3, "Kem", "The what?",
4, "boscalis", "My arguments.",
5, "Kem", "Come again?",
6, "boscalis", "The arguments you requested.",
7, "Kem", "Ah, yes!  Absolutely!  Come on, if you please!" ]

var comments2 = [0, "aolus", "The part where this tablet makes you \"vomit uncontrollably\" is a bit concerning.",
1, "JuiceAndOranges", "Please everyone, don't let that scare you off from buying it!  I'm pretty sure the problem is with me, not the tablet. No one else vomits when they use it. I tested it with my mom and some friends and they were fine, they didn’t vomit.",
2, "kepa", "Have you seen a doctor about this?",
3, "JuiceAndOranges", "I have, but it didn't help. It was a very strange experience. I explained my situation and he merely looked me over with taciturn eyes and said \"effervescent solace hath corrupted thy dominion,\" whatever the hell that means.  But then as I imposed upon him a bit with my presence his demeanor changed and he asked me to follow him.  He led me down a shockingly sterile hallway and into a room with a large ceiling-mounted device that was composed of what appeared to be an array of elementary geometric shapes.  He said nothing, and I was becoming concerned that I had overstayed my welcome, so I decided to leave.",
4, "kepa", "Are you going to get a second opinion?",
5, "JuiceAndOranges", "I should, shouldn’t I?",
2, "iejam78", "Please reply to this comment with a description of your vomiting, including as much detail as you feel is appropriate.  Thank you in advance.",
3, "JuiceAndOranges", "Well um… basically, I’ll have in mind some artistic project that I want to execute, so I’ll sit down at the computer with my graphics tablet to start drawing it.  I’m fine for a few seconds, and then I just start vomiting *everywhere*.  It’s weird, because I don’t really feel that nauseous throughout the experience, but I keep vomiting anyway.  It usually goes on for about two or three minutes.  My vision also starts to get blurry, and I stumble around the room and bump into things, and I just get vomit all over the place.  The room is so messy by the time it’s over.  If I’m able to work at all, it’s in the few minutes after I’m done vomiting, but if I keep at it, I just start vomiting again.  It really sucks, and it keeps me from being able to draw more, even though I want to.",
4, "iejam78", "Thank you for your contribution.",
0, "AzureBundle", "This product sounds horribly defective!  You should return it to the store where you bought it.",
1, "JuiceAndOranges", "Well I bought it online, not from a store, but I can check their return policy. But as I explained above, it's not the product that's defective. The vomiting is unique to me. I let my friends try it and they seemed to be having a lot of vomit-free fun with it. Poor me, forever trapped in a prison of my own vomit.",
2, "AzureBundle", "Oh, you bought it online?  I hope you don’t have to make a phone call as part of the return.  Good luck, and stay strong.",
3, "JuiceAndOranges", "Cool, thanks.",
1, "Jan", "You would actually be brave enough to return something to the store?",
2, "AzureBundle", "Well… I can’t deny that it would be difficult!  Highly stressful, really.  But yes, I think I’d be able to, as long as the conditions were right.  It would help if there were lots of other people there all returning purchases as well.  Then I’d have an example to follow.",
3, "Jan", "Yes, knowing that other shoppers are making returns is very important!  The worst part, when you’re trying to return something, is that nagging feeling you get when you're walking through the parking lot up to the front door, and you know that you're there for a different purpose than almost everyone else, and it just weighs on you and makes you nervous.  It’s hard not to get jealous of everyone else.  You think, it's going to be easy for all the other shoppers, they’re just buying something, not returning something.  You wish you could be doing what they’re doing, instead of what you’re doing.",
4, "AzureBundle", "Yes, that’s exactly it!  I do wish I could do what they’re doing.  Everyone else is there to take items, but you're there to put an item back - possibly even multiple items!  Doesn't it seem ungrateful?",
4, "uiop", "The worst part is when they ask you why you're returning the item, and you just freeze up and don't know what to say.  It’s fine if you have a legitimate reason, such as the item being defective, or it turned out to be inappropriate for the recipient (in the case of gifts), etc.  But what if you, you know, just didn’t like it?  What if you don’t really have a reason at all, the mood just struck you to return something that day?  How are you going to explain that?  Surely it will come off as terribly odd.",
5, "JuiceAndOranges", "Is this something that happens often to you?",
4, "Xblag", "I mean, the feeling I get when I look at all the other shoppers is… I’m just happy for them.  Happy that they’re going to have a nice, calm, standard shopping experience where they don’t have to make any returns.  And that gives me hope too, because I know that soon enough I’ll be just like them again, and I’ll be out shopping strictly to buy something and I won’t have any returns to make, and if I see someone making a return I’ll be hoping that I’m giving him the same sort of comfort.",
0, "yams", "I didn't want to be a nuisance and clutter up the other thread, but I just wanted to express how brave AzureBundle is for having the fortitude to actually return a product that s/he bought.  Not everyone is capable of understanding how difficult that can be, but for those of us that do, we know that it’s something to be commended.",
1, "JuiceAndOranges", "Are you going to buy my graphics tablet?",
1, "AzureBundle", "Oh, thank you so much for that compliment!  You’re right, many people just don’t understand how hard making returns can be.  I’m glad there are people around here I can share my experiences with.",
2, "uiop", "The store employee understands.",
3, "JuiceAndOranges", "Who?",
4, "uiop", "The anonymous attendant who staffs the customer service desk, who watches the returns come in on busy days and quiet days, who stands desolate and alone and will not leave until after the lights have gone out and the shopping carts sit motionless.  He understands.",
5, "Xblag", "Oftentimes, he isn’t anonymous.  He frequently has a nametag.",
6, "AzureBundle", "He doesn’t leave until after the lights have gone out?  Well, most stores have employees on a rotating schedule of sorts.  On different days, different people will be assigned different duties, so the group of employees to leave last will be different as well.  So the one who staffs the customer service desk will not always be the last one there.",
7, "uiop", "Yes, I agree.  But… wouldn’t it be nice if he *were* always the last one there?  If he were always there at night, even when he didn’t have to be, to watch over things.  I’d like to believe that.",
8, "AzureBundle", "Yeah, I’d like to believe that too."]

var comments3 = [0, "xzxz", "Just wanted to chime in, I’ve corresponded with Tom via email quite a few times in the past, and he’s always been very prompt about replying.  However, when I recently sent him a note inquiring about his availability for a business venture that I’ve been planning, I was met with complete silence.  All further attempts were met with the same.  It was very unusual of him to not reply at all, although at the time I didn’t think anything of it; people do get busy now and then.  That being said, now that his personal website seems to have vanished as well, it makes this situation all the more strange.",
1, "MrPerson", "That’s pretty weird… I really hope nothing’s happened to Tom. :/  He’s done so much for this community.",
2, "Jeff", "What could have “happened” to him?  Based on the fact that *all* of his data has been erased and he’s not answering anyone’s messages, it looks like this was intentional on his part.  He probably just got fed up with something and wanted to take a break from the internet.  It’s not unheard of.",
3, "MrPerson", "Yeah, you’re right.  It’s just such a weird and sudden event is all.  I’m just curious to know what happened.",
0, "yui74", "Any progress on getting that mirror of his tutorials up?  I was working through his C tutorial, I was in the middle of Lesson 3 I think, and I felt like I was learning so much from it.  It’s just a way better resource than anything else I’ve found out there.  Really hope someone saved a copy, I’d be bummed if it was gone.",
1, "MrPerson", "Same here.  Tom has a way of explaining things that just makes everything so clear and easy to understand. Down-to-earth way of writing, gets right to the point and teaches you what you want to know without a lot of fuss. Wish we had more technical writers like him.",
1, "Wazzx", "Uh, actually… if it turns out we *didn’t* save a copy of his tutorials, I don’t think much of value would be lost.\rThey're not very good. Beginners just think they're good because they're popular and beginners don't have any point of reference to compare to.  Plus they encourage bad coding practices.",
2, "MrPerson", "Do you think you could explain some of the issues you have with Tom's tutorials?  Specifically the \"bad coding practices\" part. I'm pretty much one of those \"beginners\" you're talking about, but Tom's tutorials have been a big help to me. They got me up and running writing my own programs, so where's the problem?",
3, "Wazzx", "Some of the problems are:\rPays little attention to potential security vulnerabilities. Because 100 characters is big enough to hold any string in the world, right?  Hello buffer overflows!  You want to develop good habits early.\rPoorly explains the uses of dynamic memory allocation. Allocates things on the heap that should clearly go on the stack.\rRelies on undefined behavior in a few places.\rReally, there are better-quality resources out there.",
4, "MrPerson", "Hmmm, ok I do see your point. But I still think there's something to be said for a tutorial that just explains things in a way that makes it easy to get up and running as quickly as possible, and Tom's tutorials serve that role well. Some resources might focus on getting everything right and installing good habits early, but that might make them too formal and difficult to follow for beginners who just want to get their feet wet.  Besides, when it comes to subtle things like undefined behavior that does cause problems too often, beginners can get any mistakes they make corrected on forums like this.",
0, "Accent", "Sorry, just found this thread. I believe I have some information which may be relevant.\rTwo days ago, I was sent a private message by Tom in an IRC channel that we both frequent.  Based on the other comments here, this appears to be the most recent known communication that anyone has had with Tom.  Naturally, I would have liked to come forward with this information as soon as possible, for the sake of this community and for the sake of Tom’s well-being, although some unfortunate commitments have prevented me from participating in my typical online forums for the past 48 hours.  The transcript of our conversation is recorded below:\r<tom> Sir.\r<tom> Sir who I trust you, sir.\r<briskly7> Hey Tom.\r<tom> Oh yeah real standard greeting nice.\r<tom> There’s no time for that.\r<briskly7> Huh?\r<tom> They’re onto me.  I don’t know how much longer I’ll be able to run.\r<tom> I gotta get outta here.\r<tom> I gotta skip town, gotta keep moving.\r<briskly7> What are you talking about?\r<tom> What are my toes doing in my mouth?\r<tom> how many pairs of underwear do I need to buy before I can open a retail chain?\r<tom> How early did you go to bed last night?\r<tom> You need to reconfigure your conceptual map.\r<tom> And stop asking such inane irrelevant questions.\r<briskly7> Ok, can you just explain to me what’s going on?\r<tom> He’ll never get away with this.\r<tom> I’ll never forgive him for this.\r<briskly7> Tom what in the world are you talking about?\r<briskly7> Are you still there Tom?\rAnd that is where our correspondence ends.  He did not respond to my final messages, and I did not prod him further.  I can only assume that by the time I sent my final message, he had already left whatever device he was using to contact me.  It goes without saying that I found this to be a very strange correspondence, and I remain quite concerned about him.",
1, "6541", "I think we can all agree that it would be possible to speculate on a number of possible scenarios that might have caused this conversation to occur.  But, since we are all likely speculating the same set of possible scenarios, there will be no need to discuss them in this thread, correct?  And thus, for the sake of efficiency, we can all come to an agreement to not discuss them, yes?",
2, "Accent", "Yes, I agree with that reasoning and believe it to be sound.",
3, "sancas", "No disagreement from me.",
4, "Accent", "Very well.  We will not openly discuss any speculations on Tom’s condition."]

var comments4 = [0, "aplusb", "I think, at most, the answer is going to be a little higher, like maybe around 4 or so.  Have you considered any non-integer answers?  3.7 maybe?",
1, "FuzzyMaster", "I have thought about the possibility of non-integer (even irrational) answers, but I’m not exactly sure how I would get there.  The idea of 4 is good.  I’ll consider that if my current working hypothesis of 3 doesn’t pan out.",
2, "aplusb", "Sure, no problem!  Let us know if you get stuck again and need some more advice.",
0, "Mendo", "Yeah, I see what you mean about the composition, that is a tough one.  I doubt you’ll get a lot of expert help here.  But if you go to hammercounters.tj.mm.iop, you’ll probably get a much better answer.",
1, "aplusb", "Yeah, hammercounters is a really great resource.  There are lots of professionals, both academic and otherwise, who will take the time to answer your questions for free.  What a concept!  They’re generally a very polite bunch too.",
2, "Mendo", "There was a guy named xj5555585 who used to post a lot on hammercounters, he was really good at these types of problems in particular.  You might want to look him up.",
3, "FuzzyMaster", "Do you know if he still posts there?",
4, "Mendo", "I’m not sure.  I know he used to be really active a while ago.  Just go ahead and post your message and he might show up.",
5, "FuzzyMaster", "Thanks, I'll try that!"]

var comments5 = [0, "aba", "Why did you have to decrypt the files?",
1, "user1", "I forgot the password to unlock them.",
2, "aba", "That's a nice and simple answer.",
3, "user1", "I like to keep things simple and to the point.",
0, "nick", "How long did it take you to download the software?",
1, "user1", "Not very long, it was pretty fast.",
2, "nick", "That's good to hear.  My internet connection is really slow.",
0, "besc", "After decrypting the files, did you experience a problem where files on your hard drive would randomly encrypt and decrypt themselves, seemingly at very inconvenient times?",
1, "user1", "Is that a common problem that people report?  No, I didn’t experience anything like that at all.  Like I said before, the whole experience was very smooth.  I didn’t experience any problems after the fact.",
2, "nick", "I think that guy just wanted to cover all his bases.",
3, "user1", "Makes sense to me.",
0, "inc", "So, how exactly does this software work?  Isn’t the premise behind a “decryption” tool kind of weird?  Isn’t the whole point of encryption that someone can’t look at the encrypted files without the password?  If there was a tool that would just let you break any encryption then it would be a worthless system.",
1, "user1", "I think one of the things it does is just try a bunch of common passwords really fast.  It also checks to see if the files were encrypted with old encryption algorithms that have known vulnerabilities.  I don’t really know all the details though, I’m not an expert or anything.",
2, "inc", "So you were using a really simple bad password and that’s why the software worked?",
3, "user1", "Yeah maybe.",
0, "bb", "Do you need to have a fast computer to run the software?",
1, "user1", "That's a really personal question, I don't feel comfortable answering that.",
2, "bb", "Whoa, take it easy man, it was just a question, chill out.",
3, "user1", "Ok well maybe you should back off then.",
0, "Jack", "Can you send me the files you decrypted?",
1, "user1", "Sure, just give me your email address and I can send them to you.",
1, "nick", "There are better places to get files.",
2, "Jack", "I know."]

var comments0 = comments5
var thread_title = "File Decryption"
var submitter = "user1"
var thread_id = "decryptthread"
var self_text_art = "Selling:  Graphics tablet.\rPrice:  $200.00.\rDescription:  Barely used graphics tablet with touch/stylus input and scroll wheel. Perfect for drawing, photo editing, taking notes, etc. Selling it because I start vomiting uncontrollably whenever I try to use it -- hope it goes to a good home!  Stylus and driver CD included of course. Compatible with all major graphics/photo software packages. Virtually in mint condition!  I did have to clean vomit off it several times, but it didn't leave a stain or anything."
var self_text_hc = "Hey guys.  So yeah, sorry to be bothering you all with a homework question, I know you guys have been getting a lot of that lately.  I’m having a really tough time with this hammer counting problem though.  You can see the picture here:\r\rfreeimagehosting.hc.em.gbq/image?id=j7a65nn8\r\rBasically I think I’ve narrowed the answer down to either 2 or 3.  But certain aspects of the composition of the photo are giving me trouble.  Can anyone let me know if I’m on the right track with the estimate I have?  Thanks."
var self_text_decrypt = "Hey guys, I had to decrypt some encrypted files on my computer recently and I used a piece of software called QDecrypt to do it.  It was a really good experience.  I’m here to talk about the software and my experience using it.  Go ahead and ask about whatever you’re interested in and I’ll do my best to answer you.";
var self_size = 0
var self_text_tom = "So like a lot of people here recommended, I’ve been using Tom’s tutorials to teach myself computer programming (his C tutorial in particular has really helped me a lot).  But all of a sudden a few days ago, his entire internet presence vanished!  His personal site is gone, as well as all of his guest blog posts on other sites.  Even all of the code repositories he had on various open source sites are gone.  No one I’ve talked to seems to know what happened.  So does anyone have any info on why Tom vanished all of a sudden?  And does anyone have a mirror of his tutorials?  I want to keep using them!"
var self_text = self_text_decrypt

var originalUnit = preferences.rulerUnits
preferences.rulerUnits = Units.INCHES
var docRef = app.activeDocument;
app.preferences.rulerUnits = originalUnit

if (self_text != "")
{
	docRef.artLayers[0].textItem.kind = TextType.PARAGRAPHTEXT
	docRef.artLayers[0].textItem.width = 1300
	docRef.artLayers[0].textItem.height = 300
	docRef.artLayers[0].textItem.contents = self_text
	var self_delta = docRef.artLayers[0].bounds[3] - docRef.artLayers[0].bounds[1]
	docRef.artLayers[1].translate(0, self_delta + 10)
	self_size = self_delta + 20
}

docRef.artLayers[docRef.artLayers.length - 5].textItem.contents = thread_title
docRef.artLayers[docRef.artLayers.length - 5].name = thread_id + "-"
var prev = docRef.artLayers[docRef.artLayers.length - 7].bounds[2]
docRef.artLayers[docRef.artLayers.length - 7].textItem.contents = submitter
docRef.artLayers[docRef.artLayers.length - 7].name = ";" + submitter + "0-"
var delta = docRef.artLayers[docRef.artLayers.length - 7].bounds[2] - prev
docRef.artLayers[docRef.artLayers.length - 8].translate(delta, 0)
docRef.artLayers[docRef.artLayers.length - 9].translate(delta, 0)
var num_comments = comments0.length / 3
docRef.artLayers[docRef.artLayers.length - 9].textItem.contents = num_comments.toString() + " comments"
docRef.artLayers[docRef.artLayers.length - 9].name = ";" + thread_id + "-"

prev1 = 0
prev2 = 0
for (i = 0; i < comments0.length; i += 3)
{	
	var byLayer = docRef.artLayers.add()
	byLayer.kind = LayerKind.TEXT
	var byLayerTextRef = byLayer.textItem
	byLayerTextRef.size = 11
	byLayerTextRef.contents = "by "
	var nameLayer = docRef.artLayers.add()
	nameLayer.kind = LayerKind.TEXT
	var nameLayerTextRef = nameLayer.textItem
	nameLayerTextRef.size = 11
	nameLayerTextRef.contents = comments0[i + 1]
	var commentLayer = docRef.artLayers.add()
	commentLayer.kind = LayerKind.TEXT
	var commentLayerTextRef = commentLayer.textItem
	commentLayerTextRef.kind = TextType.PARAGRAPHTEXT
	commentLayerTextRef.width = 1150
	commentLayerTextRef.height = 300
	commentLayerTextRef.size = 14
	commentLayerTextRef.contents = comments0[i + 2]
	//commentLayerTextRef.convertToShape()
	commentLayer.translate(0, byLayer.bounds[3] - byLayer.bounds[1] + 3)
	var xtrans = comments0[i] * 20
	var ytrans = 0
	if (prev1 != 0)
	{
		ytrans = (prev1 - byLayer.bounds[1]) + (prev2 - prev1) + 30
	}
	
	ytrans += (80 + self_size)
	xtrans += 39
	var voteCopy = docRef.artLayers[docRef.artLayers.length - 3].duplicate()
	voteCopy.translate(xtrans + 161, ytrans + 130)
	voteCopy.name = "vote-"
	byLayer.translate(xtrans, ytrans)
	commentLayer.translate(xtrans, ytrans)
	nameLayer.translate(xtrans + 15, ytrans)
	prev1 = byLayer.bounds[1]
	prev2 = commentLayer.bounds[3] - (80 + self_size)
	nameLayer.name = ";" + comments0[i + 1] + "0-"
}

var delta = prev2 + (80 + self_size) + 56 - docRef.height;
if (delta > 0)
{
for (var i = 0; i < docRef.artLayers.length; ++i)
{
	if (docRef.artLayers[i].name == "footer" || docRef.artLayers[i].name == "sleepy.oo.oo.zzz/agreement-" || docRef.artLayers[i].name == "sleepy.oo.oo.zzz/privacy-")
	{
		docRef.artLayers[i].translate(0, delta + 56);
	}
	
	if (docRef.artLayers[i].name == "whitebg" || docRef.artLayers[i].name == "Layer 0")
	{
		var original_height = app.activeDocument.artLayers[i].bounds[3] - app.activeDocument.artLayers[i].bounds[1];
		var percent = (original_height + delta + 56) / original_height * 100.0;
		app.activeDocument.artLayers[i].resize(100, percent, AnchorPosition.TOPLEFT);
	}
}

var height = app.activeDocument.height;
var width = app.activeDocument.width;
app.activeDocument.resizeCanvas(width, height + delta + 56, AnchorPosition.TOPLEFT);
}

docRef = null
artLayerRef = null
textItemRef = null